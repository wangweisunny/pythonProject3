# 模拟 PE 文件头和常见恶意代码
with open("test_malware_1.bin", "wb") as f:
    # MZ 头
    f.write(b"\x4D\x5A\x90\x00\x03\x00\x00\x00\x04\x00\x00\x00\xFF\xFF\x00\x00\xB8\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x00\x00\x00\x00\x00")
    # PE 头
    f.write(b"\x50\x45\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00")
    # 模拟壳代码
    f.write(b"\x55\x8B\xEC\x83\xEC\x10\x33\xC0\x60\xE8\x00\x00\x00\x00\x83\xC4\x04")
    # 模拟加密模式
    f.write(b"\x55\x8B\xEC\x83\xEC\x0C\x33\xC0\xE8\x00\x00\x00\x00\x83\xC4\x04")
    # 填充随机数据
    import random
    for _ in range(1024):
        f.write(random.choice([b"\x00", b"\xFF", b"\x12", b"\x34", b"\x56", b"\x78", b"\x9A", b"\xBC", b"\xDE"]))